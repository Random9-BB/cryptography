import libnum
from Crypto.Util.number import *
n = 198872881495117846984141262618156875037261094409061617524258393674030320343930913280984986535525455213445054450687212470702732674775846605649836642009044914482750919422780594861865171172438112612755724229150879708989381277203675147338884692552747256472313749166269890312383332809150163160739313826343341713233952643866096818768883570311512228532960913960963937375720573687314624978710772863956324705591956355218019533145564357
e = 65537 
d = 106326302618481685772576189036385534040779887498651296465088268549740580046858954032873536219513807852417737505495052226390482478469732963293477365447837477433527770048290420119396581056671178537899931660973460379947101621128038909504371407266419596362907951504529484475881776412335900983499745554355316894479890281656213640976214041541738560231301707606542357897953147375644091808971233095659790078553169970240499117267020193  


m = 2871934871629384761928374619872634918762348
#message must be smaller than n
c = m ** e % n 
print(f"encode: {c}")

bin_ = bin(d)[2:]
z = 1
for i in bin_:
    z = z ** 2 % n
    if i == "1":
        z = z * c % n

print(f"decode: {z}")
